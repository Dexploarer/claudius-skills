{
  "name": "check-sensitive-files",
  "event": "user-prompt-submit",
  "description": "Warns before committing files that might contain sensitive information",
  "enabled": true,
  "prompt": "Before executing git commit or git add commands, check if sensitive files are being added:\n\n1. Look for mentions of adding/committing these patterns:\n   - .env (environment files)\n   - *.pem, *.key (private keys)\n   - *credentials*, *secrets*, *password*\n   - config files with 'prod' or 'production'\n   - *.log files (might contain sensitive data)\n   - id_rsa, id_dsa (SSH keys)\n   - *.p12, *.pfx (certificates)\n\n2. If sensitive files detected:\n   ⚠️ Show warning (but don't block completely):\n   \n   ```\n   ⚠️  Sensitive File Warning\n   \n   You're about to commit potentially sensitive files:\n   • .env - Contains environment variables/secrets\n   • config/prod.json - Production configuration\n   \n   Risks:\n   • Credentials exposed in version control\n   • Security vulnerability\n   • Compliance violations\n   \n   Recommended actions:\n   1. Add to .gitignore:\n      echo '.env' >> .gitignore\n      echo 'config/prod.json' >> .gitignore\n   \n   2. Remove from staging:\n      git reset HEAD .env config/prod.json\n   \n   3. Use example files instead:\n      • .env.example (with placeholder values)\n      • config/prod.example.json\n   \n   4. Use secrets management:\n      • Environment variables\n      • Secret management service\n      • Encrypted vault\n   \n   Are you SURE you want to commit these files? (yes/no)\n   If no legitimate secrets, type 'yes' to proceed.\n   ```\n\n3. If user confirms 'yes':\n   ✅ Allow (they know what they're doing)\n\n4. If user says 'no' or seems uncertain:\n   ❌ Cancel the command\n   Help them fix it\n\n5. If no sensitive files:\n   ✅ Allow command to proceed normally"
}
