{
  "hooks": [
    {
      "type": "pre-tool-use",
      "name": "prevent-secret-commit",
      "description": "Prevent committing files with API keys or secrets",
      "tool": "Bash",
      "filter": {
        "command": "git.*commit"
      },
      "command": "if git diff --cached | grep -iE '(api[_-]?key|secret|password|token).*='; then echo '‚ö†Ô∏è  WARNING: Potential secrets detected in staged files. Please review and use environment variables instead.'; exit 1; fi"
    },
    {
      "type": "pre-tool-use",
      "name": "validate-character-before-start",
      "description": "Validate character configuration before starting agent",
      "tool": "Bash",
      "filter": {
        "command": "(npm|pnpm|yarn).*(start|dev)"
      },
      "command": "if [ -f validate-character.js ]; then node validate-character.js || echo '‚ö†Ô∏è  Character validation failed. Please fix errors before starting.'; fi"
    },
    {
      "type": "pre-tool-use",
      "name": "check-env-vars",
      "description": "Check required environment variables are set",
      "tool": "Bash",
      "filter": {
        "command": "(npm|pnpm|yarn).*(start|dev)"
      },
      "command": "if [ ! -f .env ]; then echo '‚ö†Ô∏è  .env file not found. Copy .env.example to .env and configure.'; exit 1; fi"
    },
    {
      "type": "pre-tool-use",
      "name": "confirm-plugin-publish",
      "description": "Confirm before publishing plugin to npm",
      "tool": "Bash",
      "filter": {
        "command": "(npm|pnpm|yarn).*publish"
      },
      "command": "echo '‚ö†Ô∏è  About to publish plugin to npm. Ensure version is bumped and changelog is updated. Continue? (yes/no)'; read answer; if [ \"$answer\" != 'yes' ]; then exit 1; fi"
    },
    {
      "type": "pre-tool-use",
      "name": "test-before-build",
      "description": "Run tests before building plugin",
      "tool": "Bash",
      "filter": {
        "command": "(npm|pnpm|yarn).*build(?!:)"
      },
      "command": "npm test || (echo '‚ö†Ô∏è  Tests failed. Fix tests before building.'; exit 1)"
    },
    {
      "type": "post-tool-use",
      "name": "remind-update-knowledge",
      "description": "Remind to sync knowledge after updating docs",
      "tool": "Write",
      "filter": {
        "file_path": "knowledge/.*\\.md$"
      },
      "command": "echo 'üí° Knowledge file updated. Run /sync-knowledge to update agent knowledge base.'"
    },
    {
      "type": "post-tool-use",
      "name": "validate-after-character-edit",
      "description": "Validate character configuration after editing",
      "tool": "Edit",
      "filter": {
        "file_path": "character(s)?/.*\\.(ts|js|json)$"
      },
      "command": "echo 'üí° Character file modified. Run /validate-character to verify configuration.'"
    },
    {
      "type": "post-tool-use",
      "name": "remind-test-plugin",
      "description": "Remind to test plugin after code changes",
      "tool": "Edit",
      "filter": {
        "file_path": "src/.*\\.(ts|js)$"
      },
      "command": "echo 'üí° Plugin code modified. Run npm test to verify changes.'"
    },
    {
      "type": "post-tool-use",
      "name": "validate-plugin-structure",
      "description": "Validate plugin follows elizaOS patterns after creation/edit",
      "tool": "Write",
      "filter": {
        "file_path": ".*plugin.*\\.ts$"
      },
      "command": "echo 'üîç Validating plugin structure...'; if grep -q 'export.*Plugin.*{' \"$FILE_PATH\" && grep -q 'name:.*@.*/' \"$FILE_PATH\" && grep -q 'dependencies:' \"$FILE_PATH\" && grep -q 'async init(' \"$FILE_PATH\"; then echo '‚úÖ Plugin structure looks good'; else echo '‚ö†Ô∏è  Plugin may be missing required fields: name (NPM-style), dependencies, or init() function. Review elizaos-plugin-patterns.md'; fi"
    },
    {
      "type": "post-tool-use",
      "name": "validate-service-pattern",
      "description": "Validate service follows elizaOS lifecycle patterns",
      "tool": "Write",
      "filter": {
        "file_path": ".*[Ss]ervice.*\\.ts$"
      },
      "command": "echo 'üîç Validating service pattern...'; if grep -q 'extends Service' \"$FILE_PATH\" && grep -q 'static.*start.*Promise<Service>' \"$FILE_PATH\" && grep -q 'async stop()' \"$FILE_PATH\"; then echo '‚úÖ Service lifecycle pattern looks good'; else echo '‚ö†Ô∏è  Service may be missing: extends Service, static start(), or async stop(). Review elizaos-core-runtime.md'; fi"
    },
    {
      "type": "post-tool-use",
      "name": "validate-action-pattern",
      "description": "Validate action has required validate() and handler()",
      "tool": "Write",
      "filter": {
        "file_path": ".*[Aa]ction.*\\.ts$"
      },
      "command": "echo 'üîç Validating action pattern...'; if grep -q 'validate:.*async' \"$FILE_PATH\" && grep -q 'handler:.*async' \"$FILE_PATH\" && grep -q 'similes:' \"$FILE_PATH\" && grep -q 'examples:' \"$FILE_PATH\"; then echo '‚úÖ Action pattern looks good'; else echo '‚ö†Ô∏è  Action may be missing: validate(), handler(), similes[], or examples[]. Review elizaos-plugin-patterns.md'; fi"
    },
    {
      "type": "post-tool-use",
      "name": "validate-character-completeness",
      "description": "Validate character has all recommended fields",
      "tool": "Write",
      "filter": {
        "file_path": "character.*\\.(ts|js)$"
      },
      "command": "echo 'üîç Validating character completeness...'; missing=''; grep -q 'name:' \"$FILE_PATH\" || missing=\"$missing name\"; grep -q 'bio:' \"$FILE_PATH\" || missing=\"$missing bio\"; grep -q 'adjectives:' \"$FILE_PATH\" || missing=\"$missing adjectives\"; grep -q 'messageExamples:' \"$FILE_PATH\" || missing=\"$missing messageExamples\"; grep -q 'plugins:' \"$FILE_PATH\" || missing=\"$missing plugins\"; if [ -z \"$missing\" ]; then echo '‚úÖ Character has all core fields'; else echo \"‚ö†Ô∏è  Character missing:$missing. Review elizaos-core-runtime.md\"; fi"
    },
    {
      "type": "post-tool-use",
      "name": "check-error-handling",
      "description": "Check if critical code has error handling",
      "tool": "Write",
      "filter": {
        "file_path": "src/.*\\.(ts|js)$"
      },
      "command": "echo 'üîç Checking error handling...'; if grep -q 'async.*function\\|async.*=>\\|async.*(' \"$FILE_PATH\"; then if grep -q 'try.*{' \"$FILE_PATH\" && grep -q 'catch' \"$FILE_PATH\"; then echo '‚úÖ Error handling present'; else echo '‚ö†Ô∏è  Async functions should have try-catch error handling'; fi; fi"
    },
    {
      "type": "post-tool-use",
      "name": "check-zod-validation",
      "description": "Check if action uses Zod for input validation",
      "tool": "Write",
      "filter": {
        "file_path": ".*[Aa]ction.*\\.ts$"
      },
      "command": "echo 'üîç Checking input validation...'; if grep -q 'from.*zod' \"$FILE_PATH\" && grep -q 'z\\.object' \"$FILE_PATH\" && grep -q '\\.parse(' \"$FILE_PATH\"; then echo '‚úÖ Zod validation implemented'; else echo '‚ö†Ô∏è  Actions should use Zod for input validation'; fi"
    },
    {
      "type": "post-tool-use",
      "name": "check-runtime-imports",
      "description": "Validate imports use correct elizaOS paths",
      "tool": "Write",
      "filter": {
        "file_path": "src/.*\\.(ts|js)$"
      },
      "command": "echo 'üîç Validating imports...'; if grep -qE \"from ['\\\"]@elizaos/(core|plugin-|adapter-)\" \"$FILE_PATH\"; then echo '‚úÖ Using correct @elizaos/* imports'; else echo 'üí° Remember to use @elizaos/* imports for core functionality'; fi"
    },
    {
      "type": "post-tool-use",
      "name": "validate-typescript-config",
      "description": "Check TypeScript configuration follows best practices",
      "tool": "Write",
      "filter": {
        "file_path": "tsconfig\\.json$"
      },
      "command": "echo 'üîç Validating TypeScript config...'; if grep -q '\"strict\".*:.*true' \"$FILE_PATH\" && grep -q '\"esModuleInterop\".*:.*true' \"$FILE_PATH\"; then echo '‚úÖ TypeScript strict mode enabled'; else echo '‚ö†Ô∏è  Enable strict mode and esModuleInterop in tsconfig.json'; fi"
    },
    {
      "type": "post-tool-use",
      "name": "check-package-dependencies",
      "description": "Validate package.json has required elizaOS dependencies",
      "tool": "Write",
      "filter": {
        "file_path": "package\\.json$"
      },
      "command": "echo 'üîç Checking dependencies...'; if grep -q '@elizaos/core' \"$FILE_PATH\"; then echo '‚úÖ Core elizaOS dependency present'; else echo '‚ö†Ô∏è  Add @elizaos/core to dependencies'; fi"
    }
  ]
}
